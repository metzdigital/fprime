<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Deframer Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">NASA-v1.6.0</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_svc_deframer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Deframer Component </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md311"></a>
Svc::Deframer Deframer Component</h1>
<p>Deframer takes a stream of bytes from ground, checks the header and footer, and then extracts message data from the stream. The extracted data usually is passed to the service layer (typically CmdDisp, FileUplink, or a GenericHub). The Deframer uses a <code>DeframingProtocol</code> for the same abstraction that the Framer uses <code>FramingProtocol</code>. Deframer is backed by a circular buffer such that incomplete messages are reassembled. It also can be hooked up in two ways:</p><ol type="1">
<li>Polling (for drivers without their own thread/scheduling): In this configuration Deframer will poll the driver looking for new data.</li>
<li>Callback (for drivers with a thread/scheduling): In this configuration the driver pushes data to the Deframer.</li>
</ol>
<p>Note: User should hook up only one of the configurations at a time.</p>
<h2><a class="anchor" id="autotoc_md312"></a>
Design</h2>
<ol type="1">
<li>Deframer will accept incoming buffers.</li>
<li>Upon buffer receipt, it will delegate processing to a <code>DeframingInstance</code>.<ol type="a">
<li>If that delegation returns an error, it will discard the first byte and keep processing.</li>
<li>If that delegation returns need more status, it will accumulate more buffers until it has the size specified, and then rerun the processing.</li>
<li>If that delegation returns success, it will discard <code>size</code> bytes and start at the next message.</li>
</ol>
</li>
<li>When a <code>route</code> call is called-back to the Deframer, it will send the message to the <code>Fw::Com</code> output port of the <code><a class="el" href="class_fw_1_1_buffer.html">Fw::Buffer</a></code> output port based on the specified type in the route call.</li>
<li>If an allocate callback is made, it will delegate that allocation to the bufferAllocate call.</li>
<li>If step three is routing to <code>Fw::Com</code>, it must pass the buffer to the <code>bufferDeallocate</code> port.</li>
</ol>
<h2><a class="anchor" id="autotoc_md313"></a>
Usage Examples</h2>
<p>When Deframer component receives the data from a manager component (typically a service layer such as ground uplinkComm or TcpClient) via polling or a callback, the Deframer will perform the deserialization per <code>DeframingProtocol</code> and will transfer the stream via <code>bufferOut</code> or <code>comOut</code> port to components such as <code>CmdDisp</code>, <code>FileUplink</code>, or a <code>GenericHub</code>.</p>
<p>The following diagram is an example of Deframer usage with and <code>uplinkComm</code> component:</p>
<p><img src="./img/deframer_example_1.png" alt="framer_example" class="inline"/></p>
<p>The following diagram is an example of Deframer usage with a <code>TcpClient</code> and <code>GenericHub</code> component:</p>
<p><img src="./img/deframer_example_2.png" alt="framer_example" class="inline"/></p>
<p>The following is a typical Deframing setup:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Svc::FprimeDeframing deframing_obj; // Deframing protocol obj;</div>
<div class="line">Svc::DeframerComponentImpl uplink_obj(&quot;Deframer&quot;); // Deframer obj</div>
<div class="line"> </div>
<div class="line">uplink_obj.init(0);</div>
<div class="line">uplink_obj.setup(deframing_obj);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md314"></a>
Class Diagram</h2>
<p><img src="./img/class_diagram_deframer.png" alt="classdiagram" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md315"></a>
Requirements</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Validation  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TBD </td><td class="markdownTableBodyNone">TBD </td><td class="markdownTableBodyNone">TBD  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md316"></a>
Change Log</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2021-01-30 </td><td class="markdownTableBodyNone">Initial Draft  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
